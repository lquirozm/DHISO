<section class="main-section" id="Contacto">
    <header>
        <h2>Tienes un proyecto en mente? Estamos listos para escucharte</h2>
    </header>
    <section class="contact_form">
        <article class="contact">
            <h3>CONTACTANOS</h3>
            <p>Tel. +56 938967493</p>
            <p>Villanelo N° 180 Viña del Mar - CHILE.</p>
            <p>Ventas@dhisoingenieriayconstruccion.com</p>
            <div class="contact-media">
                <a
                    href="https://www.instagram.com/dhiso_ingenieria/"
                    target="_blank"
                >
                    <svg
                        viewBox="0 0 24 24"
                        stroke-width="1.5"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                    >
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"
                        ></path>
                        <path
                            d="M4 4m0 4a4 4 0 0 1 4 -4h8a4 4 0 0 1 4 4v8a4 4 0 0 1 -4 4h-8a4 4 0 0 1 -4 -4z"
                        ></path>
                        <path d="M12 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"
                        ></path>
                        <path d="M16.5 7.5l0 .01"></path>
                    </svg>
                </a>
                <a href="https://wa.link/6hkelm" target="_blank">
                    <svg
                        viewBox="0 0 24 24"
                        stroke-width="1.5"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                    >
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"
                        ></path>
                        <path d="M3 21l1.65 -3.8a9 9 0 1 1 3.4 2.9l-5.05 .9"
                        ></path>
                        <path
                            d="M9 10a.5 .5 0 0 0 1 0v-1a.5 .5 0 0 0 -1 0v1a5 5 0 0 0 5 5h1a.5 .5 0 0 0 0 -1h-1a.5 .5 0 0 0 0 1"
                        ></path>
                    </svg>
                </a>
            </div>
        </article>
        <form id="emailForm" method="POST">
            <input
                class="input-form"
                type="text"
                placeholder="Nombre Completo"
                name="name"
                required
            />
            <input
                class="input-form"
                type="email"
                placeholder="e-mail"
                name="email"
                required
            />
            <textarea
                placeholder="Escribe aquí tu mensaje..."
                name="message"
                required></textarea>
            <input type="submit" value="Enviar" />
        </form>
    </section>
</section>

<style>
    .main-section {
        width: 100%;
        height: auto;
        padding: 25px 20px;
        background: var(--light-blue);
        background-image: url("/images/fondo4.png");
        background-repeat: no-repeat;
        background-size: cover;
        background-position: center;
        background-blend-mode: multiply;
    }
    header {
        width: 100%;
        margin-bottom: 30px;
        display: flex;
        justify-content: flex-start;
    }
    header h2 {
        margin: 0 auto;
        max-width: 680px;
        border-top: 3px solid var(--red);
        font-family: var(--cocogoose-light);
        font-weight: 800;
        font-size: 3.8rem;
        line-height: 4.2rem;
        color: #fff;
    }
    .contact_form {
        margin: 0 auto;
        width: 100%;
        max-width: 680px;
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        gap: 25px;
    }
    .contact_form .contact {
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: flex-start;
    }
    .contact_form .contact h3 {
        margin-bottom: 10px;
        font-family: var(--cocogoose-light);
        font-size: 2.4rem;
        font-weight: 500;
        line-height: 2.6rem;
        color: #fff;
    }
    .contact_form .contact p {
        font-family: var(--helvetica-regular);
        font-size: 1.8rem;
        line-height: 2.2rem;
        color: #fff;
    }
    .contact_form .contact p:first-of-type {
        font-size: 2.3rem;
        line-height: 2.7rem;
    }
    .contact-media {
        margin-top: 10px;
        width: 100%;
        display: flex;
        justify-content: flex-start;
        gap: 15px;
    }
    .contact-media svg {
        height: 45px;
        width: 45px;
        stroke: white;
        fill: none;
        transition: all 0.3s ease-in-out;
    }
    .contact-media svg:hover {
        stroke: var(--red);
        transform: scale(1.05);
    }
    form {
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 16px;
    }
    form .input-form {
        padding: 8px 28px;
        width: 100%;
        border: none;
        border-radius: 3px;
        font-family: var(--cocogoose-light);
        font-weight: 500;
        font-size: 1.6rem;
        color: var(--dark-blue);
    }
    form .input-form::placeholder {
        font-family: var(--cocogoose-light);
        font-weight: 500;
        font-size: 1.6rem;
        color: #c5c5c5;
    }
    form textarea {
        width: 100%;
        height: 120px;
        padding: 8px 28px;
        border-radius: 3px;
        font-family: var(--cocogoose-light);
        font-weight: 500;
        font-size: 1.6rem;
        color: var(--dark-blue);
        resize: none;
    }
    form textarea::placeholder {
        color: #c5c5c5;
    }
    form input[type="submit"] {
        cursor: pointer;
        border: none;
        width: 100%;
        max-width: 170px;
        padding: 17px 54px;
        background-color: var(--red);
        font-family: var(--cocogoose-light);
        font-size: 1.6rem;
        font-weight: 500;
        color: #fff;
        transition: all 0.3s ease-in-out;
    }
    form input[type="submit"]:hover {
        background-color: #910c0c;
    }

    @media only screen and (min-width: 1025px) {
        .main-section {
            padding: 80px 80px 260px;
        }
        header {
            margin-bottom: 176px;
        }
        header h2 {
            text-align: center;
        }
        .contact_form {
            max-width: 1020px;
            flex-direction: row;
            justify-content: space-between;
        }
        .contact_form .contact {
            max-width: 360px;
        }
        form {
            max-width: 610px;
            align-items: flex-start;
        }
    }
</style>

<script>
    import Swal from "sweetalert2";

    document.addEventListener("DOMContentLoaded", () => {
        const form = document.getElementById("emailForm");

        form.addEventListener("submit", async (e) => {
            e.preventDefault();
            
            const name = form.elements["name"].value;
            const email = form.elements["email"].value;
            const message = form.elements["message"].value;

            try {
                const response = await fetch(
                    "https://dhiso-backend.onrender.com/emails",
                    {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({ name, email, message }),
                    },
                );

                if (response.ok) {
                    const data = await response.json();
                    Swal.fire({
                        title: "¡Listo!",
                        text: data.message,
                        icon: "success",
                        width: 600,
                        customClass: {
                            popup: 'swal2-popup'
                        }
                        });
                } else {
                    const errorData = await response.json();
                    Swal.fire({
                        title: "Error",
                        text: errorData.message || "Hubo un error al enviar tu mensaje.",
                        icon: "error",
                        width: 600,
                        customClass: {
                            popup: 'swal2-popup'
                        }
                    });
                        
                }

                // Reiniciar el formulario y limpiar los campos
                form.reset();
            } catch (error) {
                Swal.fire({
                    title: "Error",
                    text: "Hubo un error al enviar tu mensaje. Por favor, inténtalo de nuevo más tarde.",
                    icon: "error",  
                    width: 600,
                        customClass: {
                            popup: 'swal2-popup'
                        }  
                });
            }
        });
    });
</script>
